---
- defaults:
    link:
      relink: true
      create: true
      glob: true
    clean:
      force: true
      recursive: true

- clean:
    ~/:
      recursive: false
    ~/.config:
    ~/.bin:

- ghq:
    - zsh-users/zsh-syntax-highlighting.git
    - zsh-users/zsh-autosuggestions
    - jreese/zsh-titles
    - psprint/zsh-navigation-tools.git

- package:
    nvim_linux:
      if: '[ "$(uname)" = "Linux" ]'
      updateCmds:
        - curl -L https://github.com/neovim/neovim/releases/download/nightly/nvim.appimage --create-dirs -o nvim_bin/nvim.appimage
        - chmod u+x nvim_bin/nvim.appimage
    nvim_darwin:
      if: '[ "$(uname)" = "Darwin" ]'
      updateCmds:
        - curl -L https://github.com/neovim/neovim/releases/download/nightly/nvim-macos.tar.gz --create-dirs -o nvim_bin/nvim-macos.tar.gz
        - tar xvf nvim_bin/nvim-macos.tar.gz -C nvim_bin
        - rm -rf nvim_bin/nvim-macos.tar.gz

- package:
    apt:
      if: '[ "$(uname)" = "Linux" ] && [ "$(whoami)" = "root" ]'
      installCmd: apt-get install
      listCmd: apt list
      updateCmds:
        - apt-get update -y --allow-unauthenticated
        - apt-get upgrade -y --allow-unauthenticated
        - apt-get dist-upgrade -y -f --allow-unauthenticated
        - apt autoremove -y -f
      packages:
        - build-essential
        - clang-format
        - cmake
        - curl
        - tmux
        - zsh

- package:
    pip:
      installCmd: pip3 install --user
      listCmd: pip3 list --user
      updateCmds:
        - pip3 freeze --local | grep -v '^-e' | cut -d = -f 1 | xargs -n1 pip3 install -U --user
      packages:
        - pynvim
        - yamllint
        - flake8
        - autopep8
        - vim-vint

- package:
    npm:
      installCmd: npm install --prefix ~/.node
      listCmd: npm list --prefix ~/.node
      updateCmds:
        - npm update --prefix ~/.node
      packages:
        - npm
        - tree-sitter-cli
        - markdownlint-cli

- package:
    lua:
      installCmd: luarocks install --server=https://luarocks.org/dev
      listCmd: luarocks list
      packages:
        - luaformatter

- package:
    brew:
      if: '[ "$(whoami)" != "root" ]'
      installCmd: brew install
      listCmd: brew ls
      updateCmds:
        - brew update
        - brew upgrade
        - brew cleanup
        - brew cleanup -s
        - brew missing
      packages:
        - lazygit
        - luarocks
        - shellcheck
        - shfmt
        - go
        - ghq
        - zoxide

# neovim specific link
- link:
    ~/bin/nvim:
      if: '[ "$(uname)" = Linux ]'
      path: nvim_bin/nvim.appimage
- link:
    ~/bin/nvim:
      if: '[ "$(uname)" = Darwin ]'
      path: nvim_bin/nvim-osx64/bin/nvim

- link:
    ~/:
      path: home/*
      prefix: '.'
    ~/.config:
      path: config/*
