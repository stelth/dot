set user_agent=no

# directories and commands
set alias_file		= ~/.mutt/mutt-alias
set header_cache	= ~/.mutt-local/hcache
set message_cachedir	= ~/.mutt-local/messagecache
set certificate_file	= ~/.mutt-local/certificates
set mailcap_path 	= ~/.mutt/mailcap
set tmpdir		= ~/.mutt-local/tmp
set editor              = "/usr/bin/vim -c 'set tw=80 ft=mail' -c 'set wrap' -c 'set nocp'"
set ispell		= "/usr/bin/aspell -e -c"

# main options
set mbox_type		= Maildir
set folder		= ~/.mail/
set trash		= ~/.mail/Trash
set spoolfile		= +/Inbox
set record		= +/Sent
set timeout		= 3
set mail_check		= 0
set sort_alias		= alias
set reverse_alias
unset move
set delete
unset confirmappend
set quit
unset mark_old
set pipe_decode
set thorough_search
set text_flowed		= yes
unset help
set sendmail		= "/usr/bin/msmtp"

# index options
set sort=threads
set sort_aux=reverse-last-date-received
set uncollapse_jump
set sort_re
set reply_regexp        = "^(([Rr][Ee]?(\[[0-9]+\])?: *)?(\[[^]]+\] *)?)*"

# pager options
set pager_index_lines	= 10
set pager_context	= 5
set pager_stop
set menu_scroll
set smart_wrap
set tilde
unset markers
set quote_regexp        = "^( {0,4}[>|:#%]| {0,4}[a-z0-9]+[>|]+)+"
set status_on_top
auto_view text/html
alternative_order text/plain text/enriched text/html

# formats
set date_format         = "%d/%m/%y at %I:%M%P"
set index_format        = "%3C  %S   %D  â€¢  %-25.25L %s %> %c"
set pager_format        = "Reading message %C of %m %> %lL [%P]" # pager statusbar
set folder_format       = "%2C %t %N %8s %d %f"                  # mailbox list view
set status_format       = " %?M?%M/?%m Mails %?n?%n new, ?%?u?%u unread, ?%?p?%p drafts, ?%?t?%t +tagged, ?%?d?%d deleted, ?[%f %l]  %?b?%b unread messages. ?%>  %V  [%P]"
set alias_format        = "%4n %t %-20a  %r"

# composing mail
set realname		= "Jason Cox"
set from		= jasonc@teamplayinc.com
set envelope_from
set sig_dashes
set edit_headers
set fast_reply
set sendmail_wait	= -1
set askcc
set askbcc
set fcc_attach
set mime_forward
set mime_forward_rest
set forward_format	= "Fwd: %s"
set forward_decode
set attribution		= "On %d, %n wrote:"
set reply_to
set reverse_name
set include
set forward_quote
set print_command	= "muttprint"

# headers to show
ignore *
unignore from: to: cc: date: subject
hdr_order from: to: cc: date: subject:

# boxes
mailboxes =Inbox
mailboxes =Sent
mailboxes =Drafts
mailboxes =Junk
mailboxes =Trash

# always sourced
source $alias_file
source ~/.mutt/mutt-colors-zenburn.muttrc

# sidebar
set sidebar_delim = '   |'
set sidebar_visible = yes
set sidebar_width = 24
set sidebar_sort = yes


# these just give me headaches
bind index,pager \# 	noop
bind index i		noop

# bindings
bind pager q		exit
bind pager /		search
bind pager k		previous-line
bind pager j		next-line
bind pager gg		top
bind pager G		bottom
bind index gg		first-entry
bind index G		last-entry
bind pager K		previous-undeleted
bind pager J		next-undeleted
bind index K		previous-unread
bind index J		next-unread
bind index W		clear-flag
bind index w		set-flag
bind index,pager R	group-reply
bind compose p		pgp-menu
bind attach <return>	view-mailcap
bind index \CP 		sidebar-prev
bind index \CN 		sidebar-next
bind index \CO 		sidebar-open
bind pager \CP 		sidebar-prev
bind pager \CN 		sidebar-next
bind pager \CO 		sidebar-open

# macros
macro index \Cr "T~U<enter><tag-prefix><clear-flag>N<untag-pattern>.<enter>" "mark all messages as read"
macro index,pager d "s=Trash\n" "move message to trash"
macro index Z "<shell-escape>/usr/bin/offlineimap -q -u TTYUI<enter>" "sync IMAP"

macro index b '<enter-command>toggle sidebar_visible<enter><refresh>'
macro pager b '<enter-command>toggle sidebar_visible<enter><redraw-screen>'

# search with notmuch
macro index <F8> \
	"<enter-command>unset wait_key<enter><shell-escape>~/.mutt/notmuch-mutt.pl --prompt search<enter><change-folder-readonly>`echo ${XDG_CACHE_HOME:-$HOME/.cache}/notmuch/mutt/results`<enter>" \
	"notmuch: search mail"
macro index <F9> \
	"<enter-command>unset wait_key<enter><enter-command>unignore message-id<enter><pipe-message>~/.mutt/notmuch-mutt.pl thread<enter><change-folder-readonly>`echo ${XDG_CACHE_HOME:-$HOME/.cache}/notmuch/mutt/results`<enter><enter-command>set wait_key<enter>" \
	"search and reconstruct owning thread with notmuch"
macro index <F6> \
	"<enter-command>unset wait_key<enter><enter-command>unignore message-id<enter><pipe-message>~/.mutt/notmuch-mutt.pl -- tag +deleted<enter>" \
	"tag messages as deleted with notmuch"

# vim: ft=muttrc
